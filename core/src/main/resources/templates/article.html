<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:http="http://www.w3.org/1999/xhtml"
      xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head th:replace="common/head :: head(~{::title},~{::link},~{})">

    <title>wiblog - Areo的个人网站</title>

    <link rel="stylesheet" th:href="@{/css/article.css}">
</head>
<body>

<div id="index-wrapper">
    <div id="index-page">
        <!--header-->
        <div th:include="common/header :: header"></div>

        <!--body-->
        <div id="post-list">
            <div class="container">
                <div id="app" class="row">

                    <section id="main" class="col-md-8">
                        <div class="card" id="article">
                            <template>
                                <div class="article-header">
                                    <div class="title text-left">{{article.title}}</div>
                                    <div class="article-data text-left">
                                    <span class="fa fa-tag tags" v-for="item in tagList">
                                        <span class="tag-text">{{item}}</span>
                                    </span>
                                        <span>
                                        <i class="fa fa-calendar"> {{article.articleTime}}</i>
                                        <i class="fa fa-commenting-o">评论{{article.commentsCounts}}</i>
                                        <i class="fa fa-eye">阅读{{article.hits}}</i>
                                        <i class="fa fa-thumbs-o-up">喜欢{{article.likes}}</i>
                                    </span>
                                    </div>
                                </div>

                            <br>
                            <div class="article-content" v-html="article.content"></div>
                            </template>


                        </div>
                        <!--评论框-->
                        <div class="card article-comment" v-show="article.comment">
                            <div class="comment-title">
                                <span>发表评论</span>
                            </div>
                            <div class="comment-avatar">
                                <img class="pull-left" v-bind:src="user_avatar">
                            </div>
                            <div class="comment-item-body reply-body no-login"
                                 v-bind:class="{nologin:nologin}">
                                <div class="no-reply-msg">请先<a class="btn-login main-background"
                                                               href="javascript:;" @click="login()">登录</a>后发表评论 (・ω・)
                                </div>

                                <div class="reply-textarea">
                                    <textarea cols="80" name="msg" rows="5" v-on:keyup.enter="replyArticle"
                                              v-model.trim="replyContent"
                                              placeholder="请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"></textarea>
                                </div>
                                <button type="submit" class="comment-submit main-background" @click="replyArticle">
                                    发表评论
                                </button>
                                <div class="comment-emoji"><i class="fa fa-smile-o"></i><span>表情</span></div>
                            </div>
                        </div>

                        <!--评论-->
                        <div id="comments" class="card article-comment" v-show="article.comment">
                            <div class="comment-title">
                                <span>全部评论</span>
                                <span class="comment-title-count">{{article.commentsCounts}}</span>
                                <div class="pull-right">
                                    <a class="" @click="getComment('asc')" v-bind:class="{active : 'asc' === orderBy}">按时间正序</a>
                                    <a class="" @click="getComment('desc')"
                                       v-bind:class="{active : 'desc' === orderBy}">按时间倒序</a>
                                </div>
                            </div>
                            <div class="comment-body">
                                <template v-if="isHasComment">
                                    <div v-for="(item,index) in commentList" :key="index">
                                        <div class="comment-item">
                                            <div class="comment-avatar">
                                                <a href="" class="pull-left">
                                                    <img alt="image" v-bind:src="item.avatarImg">
                                                </a>
                                            </div>
                                            <div class="comment-item-body">
                                                <div class="item-nickname">
                                                    <a href="javascript:void(0);">{{item.username}}</a>
                                                    <span v-if="item.username === author">（作者）</span>
                                                </div>
                                                <div class="item-state">
                                                    <span>{{item.floor}}楼</span>
                                                    <time>{{ item.createTime | commentDateFormat}}</time>
                                                </div>
                                                <div class="item-content" v-if="item.state === 1">
                                                    {{item.content}}
                                                </div>
                                                <div class="remove-comment" v-else>
                                                    该评论已删除
                                                </div>

                                                <div class="item-btn-group">
                                                    <button class="btn btn-white btn-xs">
                                                        <i class="fa fa-thumbs-up"></i> 赞
                                                    </button>
                                                    <button class="btn btn-white btn-xs" @click="showReplyBtn(index,item.id)">
                                                        <i class="fa fa-comments"></i> 回复
                                                    </button>
                                                </div>

                                                <!--楼中楼 只显示前3条-->
                                                <div v-for="(it,i) in item.subCommentVoList.slice(0,3)" :key="i"
                                                     style="margin-top: 12px;">
                                                    <div class="comment-item">
                                                        <div class="comment-avatar">
                                                            <a href="" class="pull-left">
                                                                <img alt="image" v-bind:src="it.replyAvatarImg">
                                                            </a>
                                                        </div>
                                                        <div class="comment-item-body">
                                                            <div class="item-nickname">
                                                                <a href="javascript:void(0);">{{it.replyName}}</a>
                                                                <span v-if="it.replyName === author">
                                                                    （作者）
                                                                </span>
                                                                回复{{it.replyedName}}
                                                                <span v-if="it.replyedName === author">
                                                                    （作者）
                                                                </span>
                                                            </div>
                                                            <div class="item-state">
                                                                <time>{{ it.createTime | commentDateFormat}}</time>
                                                            </div>
                                                            <div class="item-content" v-if="it.state === 1">
                                                                {{it.content}}
                                                            </div>
                                                            <div class="remove-comment" v-else>
                                                                该评论已删除
                                                            </div>

                                                            <div class="item-btn-group">
                                                                <button class="btn btn-white btn-xs"><i
                                                                        class="fa fa-thumbs-up"></i> 赞
                                                                </button>
                                                                <button class="btn btn-white btn-xs"
                                                                        @click="showReplyBtn(index,it.id)"><i
                                                                        class="fa fa-comments"></i> 回复
                                                                </button>
                                                            </div>

                                                        </div>


                                                    </div>
                                                </div>
                                                <div class="more-comment" v-if="item.subCommentVoList.length > 3">
                                                    <a href="javascript:void(0);" @click="showMoreComment(index)">查看全部{{item.subCommentVoList.length}}条回复</a>
                                                </div>
                                                <!--回复评论框-->
                                                <div style="margin-top: 12px;" v-show="showReplyIndex===index">
                                                    <div class="comment-avatar">
                                                        <img class="pull-left" v-bind:src="user_avatar">
                                                    </div>
                                                    <div class="comment-item-body reply-body show-reply"
                                                         v-bind:class="{nologin:nologin}">
                                                        <div class="no-reply-msg">请先<a class="btn-login main-background"
                                                                                       href="javascript:;" @click="login()">登录</a>后发表评论
                                                            (・ω・)
                                                        </div>

                                                        <div class="reply-textarea">
                                                        <textarea cols="80" name="msg" rows="5"
                                                                  v-on:keyup.enter="replyUser"
                                                                  v-model.trim="replyUserContent"
                                                                  placeholder="请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"></textarea>
                                                        </div>
                                                        <button type="submit" class="comment-submit main-background"
                                                                @click="replyUser(item.id)">
                                                            发表评论
                                                        </button>
                                                        <div class="comment-emoji"><i
                                                                class="fa fa-smile-o"></i><span>表情</span></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                <template v-else>
                                    <div class="no-comments">
                                        暂无评论
                                    </div>
                                </template>

                            </div>
                            <div style="text-align: right;">
                                <el-pagination
                                        small
                                        @current-change="handlePageNum"
                                        :current-page="pageNum"
                                        :page-size="pageSize"
                                        layout="prev, pager, next"
                                        :total="total"
                                        :hide-on-single-page="true">
                                </el-pagination>
                            </div>

                        </div>

                    </section>

                    <el-dialog title="查看对话" :visible.sync="moreCommentVisible" width="50%" height="50%">
                        <div id="dialog" class="comment-body" style="height: 60vh;overflow-y: auto">
                            <div class="comment-item ">
                                <div class="comment-avatar">
                                    <a href="" class="pull-left">
                                        <img alt="image" v-bind:src="commentItem.avatarImg">
                                    </a>
                                </div>
                                <div class="comment-item-body show-reply">
                                    <div class="item-nickname">
                                        <a href="javascript:void(0);">{{commentItem.username}}</a>
                                        <span v-if="commentItem.username === author">（作者）</span>
                                    </div>
                                    <div class="item-state">
                                        <span>{{commentItem.floor}}楼</span>
                                        <time>{{ commentItem.createTime | commentDateFormat}}</time>
                                    </div>
                                    <div class="item-content" v-if="commentItem.state === 1">
                                        {{commentItem.content}}
                                    </div>
                                    <div class="remove-comment" v-else>
                                        该评论已删除
                                    </div>

                                    <div class="item-btn-group">
                                        <button class="btn btn-white btn-xs">
                                            <i class="fa fa-thumbs-up"></i> 赞
                                        </button>
                                        <button class="btn btn-white btn-xs" @click="showReplyDialogBtn(-2,commentItem.id)">
                                            <i class="fa fa-comments"></i> 回复
                                        </button>
                                    </div>

                                    <!--回复评论框-->
                                    <div style="margin-top: 12px;" v-show="showReplyDialogIndex === -2">
                                        <div class="comment-avatar">
                                            <img class="pull-left" v-bind:src="user_avatar">
                                        </div>
                                        <div class="comment-item-body reply-body show-reply"
                                             v-bind:class="{nologin:nologin}">
                                            <div class="no-reply-msg">请先<a class="btn-login main-background"
                                                                           href="javascript:;" @click="login()">登录</a>后发表评论
                                                (・ω・)
                                            </div>

                                            <div class="reply-textarea">
                                                        <textarea cols="80" name="msg" rows="5"
                                                                  v-on:keyup.enter="replyUser"
                                                                  v-model.trim="replyUserContent"
                                                                  placeholder="请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"></textarea>
                                            </div>
                                            <button type="submit" class="comment-submit main-background"
                                                    @click="replyUser(commentItem.id)">
                                                发表评论
                                            </button>
                                            <div class="comment-emoji"><i
                                                    class="fa fa-smile-o"></i><span>表情</span></div>
                                        </div>
                                    </div>

                                    <!--楼中楼-->
                                    <div v-for="(it,i) in commentItem.subCommentVoList" :key="i"
                                         style="margin-top: 12px;">
                                        <div class="comment-item">
                                            <div class="comment-avatar">
                                                <a href="" class="pull-left">
                                                    <img alt="image" v-bind:src="it.replyAvatarImg">
                                                </a>
                                            </div>
                                            <div class="comment-item-body">
                                                <div class="item-nickname">
                                                    <a href="javascript:void(0);">{{it.replyName}}</a>
                                                    <span v-if="it.replyName === author">
                                                                    （作者）
                                                                </span>
                                                    回复{{it.replyedName}}
                                                    <span v-if="it.replyedName === author">
                                                                    （作者）
                                                                </span>
                                                </div>
                                                <div class="item-state">
                                                    <time>{{ it.createTime | commentDateFormat}}</time>
                                                </div>
                                                <div class="item-content" v-if="it.state === 1">
                                                    {{it.content}}
                                                </div>
                                                <div class="remove-comment" v-else>
                                                    该评论已删除
                                                </div>

                                                <div class="item-btn-group">
                                                    <button class="btn btn-white btn-xs"><i
                                                            class="fa fa-thumbs-up"></i> 赞
                                                    </button>
                                                    <button class="btn btn-white btn-xs"
                                                            @click="showReplyDialogBtn(i,it.id)"><i
                                                            class="fa fa-comments"></i> 回复
                                                    </button>
                                                </div>

                                            </div>


                                        </div>

                                        <!--回复评论框-->
                                        <div style="margin-top: 12px;" v-show="showReplyDialogIndex === i">
                                            <div class="comment-avatar">
                                                <img class="pull-left" v-bind:src="user_avatar">
                                            </div>
                                            <div class="comment-item-body reply-body show-reply"
                                                 v-bind:class="{nologin:nologin}">
                                                <div class="no-reply-msg">请先<a class="btn-login main-background"
                                                                               href="javascript:;" @click="login()">登录</a>后发表评论
                                                    (・ω・)
                                                </div>

                                                <div class="reply-textarea">
                                                        <textarea cols="80" name="msg" rows="5"
                                                                  v-on:keyup.enter="replyUser"
                                                                  v-model.trim="replyUserContent"
                                                                  placeholder="请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"></textarea>
                                                </div>
                                                <button type="submit" class="comment-submit main-background"
                                                        @click="replyUser(commentItem.id)">
                                                    发表评论
                                                </button>
                                                <div class="comment-emoji"><i
                                                        class="fa fa-smile-o"></i><span>表情</span></div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </el-dialog>
                </div>
            </div>
        </div>
    </div>



    <footer th:include="common/footer :: copyright"></footer>
</div>



<div th:replace="common/foot :: foot"></div>
<script th:src="@{../js/article.js}"></script>
</body>
</html>